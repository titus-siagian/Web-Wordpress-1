iMapsBuilder={searchInput:{},autocomplete:{},geocoder:{},regionData:{},regionsUsed:{},imageSaved:!1,needsUpdate:!1,previewBlocked:!1,advanced:!1,form:document.querySelector("form#post"),editControls:function(){var e=document.createElement("div"),t=(e.setAttribute("id","map_click_add_marker"),e.innerHTML='<span class="dashicons dashicons-plus-alt"></span><span class="map_action_label">Add Marker There</span>',document.getElementById("map_clicked_coordinates_box"));t.appendChild(e),t.style.display="block",iMapsBuilder.advanced&&((e=document.createElement("div")).setAttribute("id","map_set_center"),e.setAttribute("title","Set as initial zoom and center"),e.innerHTML='<span class="dashicons dashicons-admin-post"></span><span class="map_action_label"></span>',e.addEventListener("click",function(e){var t=document.getElementById("map_visual_info").dataset.visual,t=JSON.parse(t);iMapsBuilder.setInitialCenter(t);let a=e.target;a.classList.remove("dashicons-admin-post"),a.classList.add("dashicons-yes-alt"),setTimeout(function(){a.classList.remove("dashicons-yes-alt"),a.classList.add("dashicons-admin-post")},2500)}),(t=document.getElementById("map_visual_info_box")).appendChild(e),t.style.display="block")},setInitialCenter:function(e){var t=document.getElementsByName("map_info[viewport][zoomLevel]")[0],a=document.getElementsByName("map_info[viewport][homeGeoPoint][latitude]")[0],i=document.getElementsByName("map_info[viewport][homeGeoPoint][longitude]")[0],t=(t.value=e.zoom,a.value=e.lat,i.value=e.long,new Event("change"));i.dispatchEvent(t)},listenToClicks:function(a){console.log(iMapsData.data[0].container),document.getElementById(iMapsData.data[0].container).addEventListener("mapEntryClicked",function(e){var t=iMapsManager.maps[a].map.lastClickedEntry.dataItem.dataContext;iMapsBuilder.populateClickInfo(t)})},populateClickInfo:function(e){var t=document.getElementById("map_click_events_info"),a="";controls=!1,t&&e&&(a+="ID: "+e.id+"<br>",e.name&&(a+="Name: "+e.name+"<br>"),e.madeFromGeoData&&(controls=iMapsBuilder.addRegionButton(e.id,e.name)).addEventListener("click",function(e){e.target.classList.remove("dashicons-plus-alt"),e.target.classList.add("dashicons-yes-alt"),e.target.style.pointerEvents="none"}),e.latitude&&(a=(a+="LAT: "+Number(e.latitude).toFixed(6)+"<br>")+"LONG: "+Number(e.longitude).toFixed(6)+"<br>"),e.action&&(a+="Action: "+e.action.replace("igm_","")+"<br>"),t.parentElement.style.display="block",t.innerHTML=a,controls)&&t.appendChild(controls)},checkMaxInputVars:function(){var e=document.getElementsByTagName("input").length,t=document.getElementsByTagName("textarea").length,e=e+t,a="",i=document.getElementById("titlediv"),n=document.getElementById("map_min_req"),o='<span class="dashicons dashicons-yes-alt"></span>';console.log("Number of inputs: ",e+t),console.log("Max Input Vars: ",iMapsOptions.max_input_vars),parseInt(e)>parseInt(.75*iMapsOptions.max_input_vars)&&((a=document.createElement("div")).setAttribute("class","notice notice-error is-dismissible"),a.innerHTML="<h1>"+iMapsOptions.messages.maxInputError+"</h1>",o=i.insertBefore(a,i.childNodes[0]),o='<span class="dashicons dashicons-warning"></span>'),n.innerHTML="max_input_vars: "+e+"/"+iMapsOptions.max_input_vars+" "+o},init:function(){var e=document.getElementById("publish"),t=document.getElementById("post_ID").value;if(iMapsBuilder.addRepeatFieldsListener(),document.body.classList.contains("igm-pro")&&(iMapsBuilder.advanced=!0),iMapsBuilder.clickActionWarnings(),"undefined"!=typeof iMapsData&&(iMapsBuilder.buildPreview(),iMapsBuilder.initAvailableRegions(),iMapsBuilder.addPreviewImage(),iMapsBuilder.listenToClicks(t)),e.addEventListener("click",function(t){var a=document.getElementsByName("map_image[mapImage]")[0],e=document.getElementById("post_ID").value;void 0===a||iMapsBuilder.imageSaved||iMaps.maps&&iMaps.maps[e]&&iMaps.maps[e].map&&(t.preventDefault(),1!==iMaps.maps[e].map.zoomLevel&&iMaps.maps[e].map.goHome(0),iMaps.maps[e].map.exporting.getImage("svg").then(function(e){a.value=e,iMapsBuilder.imageSaved=!0,t.target.click()}))}),iMapsBuilder.sortableOverlay(),iMapsBuilder.autoLabelsReset(),iMapsOptions.googleApiKey&&""!==iMapsOptions.googleApiKey){for(var a=document.getElementsByClassName("geocoding"),i=0;i<a.length;i++)a.item(i).classList.remove("geocoding-hide");iMapsOptions.googleAutocomplete&&"1"===iMapsOptions.googleAutocomplete?iMapsBuilder.initGoogleAutocomplete():iMapsBuilder.initGeocoding()}iMapsBuilder.editControls(),iMapsBuilder.prepareAddMarkerActions(),setTimeout(function(){iMapsBuilder.checkMaxInputVars()},1e3)},addRepeatFieldsListener:function(){for(var e=document.getElementsByClassName("csf-cloneable-add"),t=0;t<e.length;t++)e[t].addEventListener("click",iMapsBuilder.checkMaxInputVars,!1)},clickActionWarnings:function(){var e=document.getElementsByName("map_info[regionDefaults][action]")[0],t=document.getElementsByName("map_info[markerDefaults][action]")[0],a=document.getElementById("map_info");e.addEventListener("change",function(e){"none"!==this.value?a.classList.add("igm_region_click_check"):a.classList.remove("igm_region_click_check")}),t.addEventListener("change",function(e){"none"!==this.value?a.classList.add("igm_marker_click_check"):a.classList.remove("igm_marker_click_check")}),e&&"none"!==e.value&&a.classList.add("igm_region_click_check"),t&&"none"!==t.value&&a.classList.add("igm_marker_click_check")},autoLabelsReset:function(){var e=document.getElementById("igm-reset-auto-labels");e&&e.addEventListener("click",function(e){var t;confirm(iMapsOptions.messages.resetAutoLabels)&&((t=document.getElementsByName("map_info[regionLabels][regionLabelCustomCoordinates]")[0]).value="",t.dispatchEvent(new Event("change")))})},sortableOverlay:function(){var t,e=jQuery("[data-depend-id=overlay]"),a=(e&&(t=e.first().closest("ul")).find("li").each(function(){jQuery(this).attr("title","Map ID: "+jQuery(this).find("input").attr("value"))}),e.on("change",function(){iMapsBuilder.updateOrderOverlay()}),document.querySelector("[data-depend-id=overlayOrder]"));a&&""!==a.value&&t&&(a=JSON.parse(a.value),Array.isArray(a))&&(a.reverse(),a.forEach(function(e){e=t.find("input[value="+e+"]").closest("li");e&&t.prepend(e)})),e&&(t.sortable({placeholder:"ui-state-highlight",stop:function(e,t){iMapsBuilder.previewBlocked=!0,iMapsBuilder.blockPreview(),iMapsBuilder.updateOrderOverlay()}}),e.disableSelection())},updateOrderOverlay:function(){var e=document.querySelector("[data-depend-id=overlayOrder]"),t=document.querySelectorAll("input[data-depend-id=overlay]:checked"),a=[];t&&t.forEach(function(e){a.push(e.value)}),a=JSON.stringify(a),e.value=a},prepareAddMarkerActions:function(){var a=document.getElementById("map_click_add_marker"),i=a.querySelector(".dashicons"),n=a.querySelector(".map_action_label");document.addEventListener("mapPointClicked",function(e){a.setAttribute("data-latitude",e.detail.latitude),a.setAttribute("data-longitude",e.detail.longitude),i.classList.remove("dashicons-yes-alt"),i.classList.add("dashicons-plus-alt"),n.innerHTML="Add Marker Here"}),a.addEventListener("click",function(e){e.stopPropagation();var e=a.getAttribute("data-latitude"),t=a.getAttribute("data-longitude");iMapsBuilder.addMarker(e,t),i.classList.remove("dashicons-plus-alt"),i.classList.add("dashicons-yes-alt"),n.innerHTML="Marker Added"},!1)},updateRegionsUsed:function(){var e=document.querySelectorAll(".region-code-autocomplete"),e=[].map.call(e,function(e){return e.value});return iMapsBuilder.regionsUsed=e},addPreviewImage:function(){var e=document.getElementById("map_image_preview"),t=document.getElementsByName("map_image[mapImage]")[0];t&&""!==t.value&&(e.innerHTML='<img class="igm_map_image_preview" src="'+t.value+'">')},initAvailableRegions:function(){var t,e=iMapsData.data[0];e.disabled||("custom"===e.map||e.map.startsWith("http")?fetch(e.mapURL).then(function(e){e.json().then(function(e){t=iMapsBuilder.extractGeojson(e),iMapsBuilder.updateRegionsUsed(),iMapsBuilder.populateAvailableRegions(t)})}).catch(function(e){console.error(e)}):(mapVar=iMapsRouter.getVarByName(e.map),void 0!==window[mapVar]&&(t=iMapsBuilder.extractGeojson(window[mapVar]),iMapsBuilder.updateRegionsUsed(),iMapsBuilder.populateAvailableRegions(t))))},populateAvailableRegions:function(a){iMapsData.data[0];var e,t=document.getElementsByName("map_regions_info[regionData]")[0],i=document.getElementById("map_region_data"),n=document.getElementsByName("map_info[map]")[0].selectedOptions[0].text,o={},s=[],r=document.getElementById("map_info"),d=document.createElement("div");iMapsBuilder.regionsUsed;void 0===a?a=iMapsBuilder.regionCodes:iMapsBuilder.regionCodes=a,i&&((e=document.createElement("p")).innerHTML=n,d.appendChild(e),(n=document.createElement("code")).innerHTML=iMapsOptions.messages.regionCode,d.appendChild(n),(e=document.createElement("span")).innerHTML=iMapsOptions.messages.regionName+"<br> <small>"+iMapsOptions.messages.regionCodeInfo+"</small>",d.appendChild(e),d.appendChild(document.createElement("br")),d.appendChild(document.createElement("br")),Object.keys(a).sort().forEach(function(e){o[a[e].name]=e,s.push({label:a[e].name+" ("+e+")",value:e}),void 0===a[e].name&&(void 0!==a[e].NAME?a[e].name=a[e].NAME:a[e].name=e),d.appendChild(iMapsBuilder.addRegionButton(e,a[e].name));var t=document.createElement("code"),t=(t.innerHTML=e,d.appendChild(t),d.appendChild(document.createTextNode(" ")),document.createElement("span"));t.innerHTML=a[e].name,d.appendChild(t),d.appendChild(document.createElement("br"))}),(n=document.createElement("p")).innerHTML=iMapsOptions.messages.fullData,d.appendChild(n),(e=document.createElement("div")).appendChild(d),i.innerHTML="",i.appendChild(e),n=document.createElement("DIV"),i.appendChild(n),jsonTree.create({full:a},n),t.value=JSON.stringify(o),iMapsBuilder.regionData=s,r.addEventListener("click",iMapsBuilder.clickEvents),r.addEventListener("focus",iMapsBuilder.eventRegionCodeAutocomplete,!0))},addRegionButton:function(t,a){var i,e=document.createElement("span");return iMapsBuilder.regionsUsed.includes(t.toString())?e.classList.add("dashicons","dashicons-yes-alt"):(e.classList.add("igm_add_region_btn","dashicons","dashicons-plus-alt"),e.setAttribute("title",iMapsOptions.messages.addToMap),e.onclick=function(e){e.preventDefault(),iMapsBuilder.addRegion(t,a),(previewContainer=document.querySelector(".map_wrapper"))&&(iMapsBuilder.needsUpdate=!0,previewContainer.classList.add("map_updating"),iMapsBuilder.isInViewport(previewContainer))&&(i=iMapsBuilder.form,iMapsBuilder.updatePreview(i,!1))}),e},clickEvents:function(e){e.target&&e.target.classList.contains("csf-cloneable-remove")&&((e=document.querySelector(".map_wrapper")).classList.add("map_updating"),iMapsBuilder.updateRegionsUsed(),iMapsBuilder.populateAvailableRegions(),e)&&!iMapsBuilder.isInViewport(e)&&(iMapsBuilder.needsUpdate=!0)},eventRegionCodeAutocomplete:function(t){t.target&&t.target.classList.contains("region-code-autocomplete")&&autocomplete({input:t.target,preventSubmit:!0,fetch:function(t,e){t=t.toLowerCase(),e(iMapsBuilder.regionData.filter(function(e){return e.label.toLowerCase().includes(t)}))},onSelect:function(e){t.target.value=e.value}})},extractGeojson:function(e){var t,a;return void 0===e?{error:iMapsOptions.messages.jsonError}:(t={},a=e.features||e,Object.keys(a).forEach(function(e){t[a[e].id]=a[e].properties||a[e]}),t)},buildPreview:function(){var e,t,a,i,n,o=document.getElementById("map_preview"),s=iMapsBuilder.form;window.addEventListener("scroll",function(e){iMapsBuilder.isInViewport(o)&&iMapsBuilder.needsUpdate&&iMapsBuilder.updatePreview(s,!1)},!1),a=iMapsBuilder.eventThrottle(function(e){e.target.classList.contains("chosen-search-input")||e.target.classList.contains("skip-preview")||"map_info[description]"==e.target.name||iMapsBuilder.updatePreview(s,e)},3e3),i="#map_info input, #map_info select, #map_info textarea",(n=document.querySelectorAll(i)).forEach(function(e){e.onchange=a}),document.querySelectorAll(".csf-cloneable-add").forEach(function(e){e.addEventListener("click",function(e){n.forEach(function(e){e.onchange=null}),setTimeout(function(){(n=document.querySelectorAll(i)).forEach(function(e){e.onchange=a})},500)})}),document.querySelectorAll("#map_info .csf--switcher").forEach(function(e){}),o&&(t=o.querySelector(".map_render"),e=document.getElementById("post_ID").value,t.id="map_"+e,iMapsData.data[0].disabled)&&document.getElementsByName("map_info[map]")[0].dispatchEvent(new Event("change"))},restartMap:function(){var e=document.querySelector(".map_wrapper");iMaps.maps&&(Object.keys(iMaps.maps).forEach(function(e){iMaps.maps[e].map.dispose()}),iMapsModel.prepareData(iMapsData.data).forEach(function(e,t){e.disabled||iMapsManager.init(t)}),iMapsBuilder.needsUpdate=!1),e.classList.remove("map_updating")},updatePreview:function(e,t){var a,i,n,e=new FormData(e),o=!1;!t&&!iMapsBuilder.needsUpdate||iMapsBuilder.previewBlocked||t&&!t.target.name.includes("map_info")||(iMaps.maps&&Object.keys(iMaps.maps).forEach(function(e){iMaps.maps[e],o=iMaps.maps[e].map,i=iMaps.maps[e].baseRegionSeries}),!t||"map_info[visual][paddingTop]"!=t.target.name&&"map_info[visual][maxWidth]"!=t.target.name?t&&"map_info[visual][fontFamily]"==t.target.name?(a=document.querySelector(".map_wrapper .map_box")).style.fontFamily=t.target.value:t&&"map_info[visual][backgroundColor]"==t.target.name&&o?"transparent"===t.target.value?o.background.fill=am4core.color("#f00",0):o.background.fill=am4core.color(t.target.value):t&&"map_info[visual][borderWidth]"==t.target.name&&o?i.mapPolygons.each(function(e){e.animate({property:"strokeWidth",to:t.target.value},250)}):t&&"map_info[visual][inactiveColor]"==t.target.name&&o?i.mapPolygons.each(function(e){e.dataItem.dataContext.madeFromGeoData||e.animate({property:"inactiveColor",to:t.target.value},250)}):t&&"map_info[visual][borderColor]"==t.target.name&&o?i.mapPolygons.each(function(e){e.animate({property:"stroke",to:am4core.color(t.target.value)},250)}):t&&"map_info[overlay][]"==t.target.name&&o||t&&"map_info[map]"==t.target.name&&"custom"===t.target.value&&""===t.target.value&&o||t&&"map_info[mapURL]"==t.target.name&&""!==t.target.value&&o||iMapsOptions.preview&&"1"!==iMapsOptions.preview||t&&"map_info[custom_js]"==t.target.name&&o?(iMapsBuilder.previewBlocked=!0,iMapsBuilder.blockPreview()):(n=document.querySelector(".map_wrapper"),t&&"map_info[map]"!=t.target.name&&n&&!iMapsBuilder.isInViewport(n)?(n.classList.add("map_updating"),iMapsBuilder.needsUpdate=!0):(e.append("action","map_form_data"),e.append("security",iMapsOptions.ajax_nonce),n.classList.add("map_updating"),jQuery.ajaxSetup({async:!0}),console.log(e),jQuery.ajax({url:iMapsOptions.ajax_url,type:"POST",data:e,contentType:!1,processData:!1,async:!1,success:function(e){e=[JSON.parse(e)];"object"==typeof e[0].regionLabels&&e[0].regionLabels.hasOwnProperty("regionLabelCustomCoordinates")&&(e[0].regionLabels.regionLabelCustomCoordinates=e[0].regionLabels.regionLabelCustomCoordinates.replace(/\\/g,"")),iMapsData.data=e,"undefined"!=typeof iMapsOptions&&(iMapsData.data[0]=Object.assign(iMapsData.data[0],iMapsOptions)),t&&"map_info[map]"===t.target.name?iMapsBuilder.addGeoFileSeries(e[0].mapURL,iMapsBuilder.restartMap):(iMapsBuilder.restartMap(),console.log("map updated"))},error:function(e){console.log(e)}}))):(n=document.getElementsByName("map_info[visual][maxWidth]")[0],e=document.getElementsByName("map_info[visual][paddingTop]")[0],a=document.querySelector(".map_wrapper .map_box"),document.querySelector(".map_aspect_ratio").style.paddingTop=String(e.value)+"%",""!==n&&"0"!==n&&(a.style.maxWidth=String(n.value)+"px")))},blockPreview:function(){(previewContainer=document.querySelector(".map_wrapper .map_blocked_preview")).classList.remove("map_block_hidden"),iMapsBuilder.needsUpdate=!1},addGeoFileSeries:function(i,e){return!!i&&(new Promise(function(e,t){var a=document.createElement("script");document.body.appendChild(a),a.onload=e,a.onerror=t,a.async=!0,a.src=i}).then(function(){e(),iMapsBuilder.initAvailableRegions()}),!0)},eventGeocoding:function(e){e.target&&e.target.classList.contains("geocoding-input")&&(iMapsBuilder.geocoder=new google.maps.Geocoder,iMapsBuilder.searchInput=e.target,iMapsBuilder.searchInput.addEventListener("keypress",function(e){13===(e.which||e.keyCode)&&(e.preventDefault(),iMapsBuilder.geocodeAddress())}),iMapsBuilder.searchInput.addEventListener("blur",function(e){iMapsBuilder.geocodeAddress()}))},initGeocoding:function(){var e=document.getElementById("map_info");e.addEventListener("click",iMapsBuilder.eventGeocoding),e.addEventListener("focus",iMapsBuilder.eventGeocoding,!0)},eventGoogleAutocomplete:function(e){e.target&&e.target.classList.contains("geocoding-input")&&(iMapsBuilder.autocomplete=new google.maps.places.Autocomplete(e.target,{types:["geocode"]}),iMapsBuilder.searchInput=e.target,iMapsBuilder.autocomplete.setFields(["geometry"]),iMapsBuilder.autocomplete.addListener("place_changed",iMapsBuilder.fillInAddress))},initGoogleAutocomplete:function(){var e=document.getElementById("map_info");e.addEventListener("click",iMapsBuilder.eventGoogleAutocomplete),e.addEventListener("focus",iMapsBuilder.eventGoogleAutocomplete,!0)},fillInAddress:function(e){var t=iMapsBuilder.autocomplete,a=iMapsBuilder.searchInput,a=iMapsBuilder.getClosest(a,".csf-fieldset-content"),i=new Event("change"),t=(console.log(iMapsBuilder.autocomplete),t.getPlace()),n=a.querySelector('[data-depend-id="latitude"]'),a=a.querySelector('[data-depend-id="longitude"]');t&&(n.value=t.geometry.location.lat(),a.value=t.geometry.location.lng(),n.dispatchEvent(i))},geocodeAddress:function(){var a,i=iMapsBuilder.searchInput,e=i.value,t=iMapsBuilder.geocoder,n=iMapsBuilder.getClosest(iMapsBuilder.searchInput,".csf-fieldset-content"),o=n.querySelector('[data-depend-id="latitude"]'),s=n.querySelector('[data-depend-id="longitude"]'),r=new Event("change");i.setAttribute("readonly","readonly"),t.geocode({address:e},function(e,t){"OK"===t?(a=e[0],o.value=a.geometry.location.lat(),s.value=a.geometry.location.lng(),o.dispatchEvent(r)):console.log("geocode error: "+t),i.removeAttribute("readonly")})},getClosest:function(e,t){for(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),a=t.length;0<=--a&&t.item(a)!==this;);return-1<a});e&&e!==document;e=e.parentNode)if(e.matches(t))return e;return null},swap:function(e){var t,a={};for(t in e)a[e[t]]=t;return a},eventThrottle:function(i,n,o){var s,r;return n=void 0!==n?n:250,function(){var e=o||this,t=+new Date,a=arguments;s&&t<s+n?(clearTimeout(r),r=setTimeout(function(){s=t,i.apply(e,a)},n)):(s=t,i.apply(e,a))}},addRegion:function(t,e){var a=!1,i=document.querySelector(".regions_tab .csf-cloneable-add"),n=document.querySelector("#map_info .csf-nav-metabox ul li:nth-of-type(3)");n.classList.contains("csf-section-active")||n.querySelector("a").click(),0<(n=document.querySelector(".region-code-autocomplete")).length&&n.forEach(function(e){e.value===t&&(a=!0)}),a||(i.click(),(i=(n=document.querySelector('div[data-field-id="[regions]"] .csf-cloneable-item:last-of-type')).querySelector('[data-depend-id="name"]')).value=e,i.dispatchEvent(new Event("keyup")),n.querySelector('[data-depend-id="id"]').value=t,n.querySelector('[data-depend-id="tooltipContent"]').value=e),iMapsBuilder.updateRegionsUsed(),iMapsBuilder.populateAvailableRegions()},addMarker:function(e,t){var a,i=document.querySelector(".map_wrapper"),n=document.querySelector(".markers_tab .csf-cloneable-add"),o=document.querySelector("#map_info .csf-nav-metabox ul li:nth-of-type(4)");o.classList.contains("csf-section-active")||o.querySelector("a").click(),n.click(),(o=document.querySelector('div[data-field-id="[roundMarkers]"] .csf-cloneable-item:last-of-type'))&&(n=o.querySelector('[data-depend-id="id"]'),thisID=(thisID=(thisID=n.getAttribute("name")).replace("map_info[roundMarkers]","")).replace("[id]",""),n.value="Custom Marker "+thisID,n.dispatchEvent(new Event("keyup")),o.querySelector('[data-depend-id="tooltipContent"]').value="Custom Marker "+thisID,n=o.querySelector('[data-depend-id="latitude"]'),a=o.querySelector('[data-depend-id="longitude"]'),n&&a?(n.value=e,a.value=t):(n=o.querySelector(".csf--latitude"),a=o.querySelector(".csf--longitude"),n.value=e,a.value=t,n.dispatchEvent(new Event("change"))),iMapsBuilder.needsUpdate=!0,i.classList.add("map_updating"),iMapsBuilder.isInViewport(i))&&(o=iMapsBuilder.form,iMapsBuilder.updatePreview(o,!1))},isInViewport:function(e){e=e.getBoundingClientRect();return 250<=e.bottom&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)},geoLocateInit:function(){document.querySelector('[data-depend-id="enabled"]').closest(".csf--switcher").addEventListener("click",function(){window.dispatchEvent(new Event("resize"))})}},"undefined"!=typeof iMapsOptions?iMapsBuilder.init():iMapsBuilder.geoLocateInit();